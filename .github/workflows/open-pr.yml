  name: Open Pull Request
  
  on:
    workflow_dispatch:
      inputs:
        source_branch:
          description: 'Source branch for the PR'
          required: true
          default: 'feature/new-feature'
        target_branch:
          description: 'Target branch for the PR'
          required: true
          default: 'main'
        pr_title:
          description: 'Pull request title'
          required: true
          default: 'New Feature Implementation'
        pr_body:
          description: 'Pull request description'
          required: false
          default: 'This PR implements a new feature.'

  jobs:
    create-pr:
      runs-on: ubuntu-latest
      steps:
        - name: Checkout repository
          uses: actions/checkout@v4
          with:
            token: ${{ secrets.MISHA_PAT }}
            fetch-depth: 0

        - name: Create and switch to new branch
          run: |
            git checkout -b "${{ github.event.inputs.source_branch }}"

        - name: Create dummy file
          run: |
            FILENAME="dummy-file-$(date +%s).md"
            echo "# Dummy File" > "$FILENAME"
            echo "This is a dummy file created by GitHub Actions." >> "$FILENAME"
            echo "Created on: $(date)" >> "$FILENAME"

        - name: Commit and push changes
          env:
            GITHUB_TOKEN: ${{ secrets.MISHA_PAT }}
          run: |
            git config --local user.email "action@github.com"
            git config --local user.name "GitHub Action"
            git add .
            git commit -m "Add dummy file for PR"
            git push origin "${{ github.event.inputs.source_branch }}"

        - name: Create Pull Request
          env:
            GITHUB_TOKEN: ${{ secrets.MISHA_PAT }}
          run: |
            gh pr create \
              --title "${{ github.event.inputs.pr_title }}" \
              --body "${{ github.event.inputs.pr_body }}" \
              --head "${{ github.event.inputs.source_branch }}" \
              --base "${{ github.event.inputs.target_branch }}"
